<apex:page showHeader="true" sidebar="false" controller="WhiteboardController" id="thePage">
<!-- <apex:page standardStylesheets="false" showHeader="true" sidebar="false" controller="WhiteboardController" id="thePage"> -->
    <apex:stylesheet value="{!URLFOR($Resource.bootstrap, '/bootstrap/css/bootstrap.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.WBStyles, '/css/newStyle.css')}"/>
    <script src="{!URLFOR($Resource.jQueryLibrary)}"/>
    <script src="{!URLFOR($Resource.bootstrap, '/bootstrap/js/bootstrap.js')}"/>
    <script type="text/javascript">        
        var itemId;
        var j$ = jQuery.noConflict();
        function setWhiteboardId()
        {
            document.getElementById('thePage:itemFormA:whiteboardId').value = itemId;
        }
    </script>
    
    <script type="text/javascript">
        var prev;
        var cur;
    
        function toggleicons(id) {
            cur = id;
            var down = 'icondown';
            var up = 'iconup';
            down += id;
            up += id;
            if (document.getElementById(down).style.display == 'none') {
                document.getElementById(down).style.display = '';
                document.getElementById(up).style.display = 'none';
            } else {
                document.getElementById(down).style.display = 'none';
                document.getElementById(up).style.display = '';
            }
            
            if (prev != cur && prev != null) {
                var down = 'icondown';
                var up = 'iconup';
                down += prev;
                up += prev;
                
                document.getElementById(down).style.display = '';
                document.getElementById(up).style.display = 'none';
            }
            
            prev = id;
        }
    </script>
    
        <script type="text/javascript">
        var actprev;
        var actcur;
    
        function toggleacticons(id) {
            actcur = id;
            var down = 'icondown';
            var up = 'iconup';
            down += id;
            up += id;
            if (document.getElementById(down).style.display == 'none') {
                document.getElementById(down).style.display = '';
                document.getElementById(up).style.display = 'none';
            } else {
                document.getElementById(down).style.display = 'none';
                document.getElementById(up).style.display = '';
            }

        }
    </script>
    
    <apex:outputPanel >
    <script type="text/javascript">
    function checkTheNameAndDate() {        
        var theItemName = document.getElementById('thePage:itemFormC:theItemName').value;        
        if(theItemName == '' || theItemName == null) 
        {           
            document.getElementById('nameError').style.display = 'inline'; 
            
            checkTheDate();
            
            keepModalOpen();
            return false;
        }
        else
        {
            document.getElementById('nameError').style.display = 'none';
            
            checkTheDate();
            
            return true;
        }  
    }    
        </script>
    </apex:outputPanel>
        
    <apex:outputPanel >
        <script type="text/javascript">       
    function checkTheDate() {
        var theItemDate = document.getElementById('thePage:itemFormC:theDueDate').value;             
        
        if(theItemDate == '')
            {
                document.getElementById('dateError').style.display = 'none';
                return true;
            }
        
        //Do a regex on the date                 
        //var testResult = /^(((((((0?[13578])|(1[02]))[\/]?((0?[1-9])|([12]\d)|(3[01])))|(((0?[469])|(11))[\/]?((0?[1-9])|([12]\d)|(30)))|((0?2)[\/]?((0?[1-9])|(1\d)|(2[0-8]))))[\/]?(((19)|(20))?([\d][\d]))))|((0?2)[\/]?(29)[\/]?(((19)|(20))?(([02468][048])|([13579][26])))))$/.test(theItemDate);
        var testResult = /^(((0?[1-9]|1[012])\/(0?[1-9]|1\d|2[0-8])|(0?[13456789]|1[012])\/(29|30)|(0?[13578]|1[02])\/31)\/(19|[2-3]\d)\d{2}|0?2\/29\/((19|[2-3]\d)(0[48]|[2468][048]|[13579][26])|(([2468][048]|[3579][26])00)))$/.test(theItemDate);
        
        
        //Display an error message in 'errorDate' id it doesn't fit it.
        if(!testResult)
        {
            //alert('Please Correct The Date Format');            
            //document.getElementById('dateError').innerHTML = 'Please Enter Date with MM/DD/YYYY Format';  
            document.getElementById('dateError').style.display = 'inline';
            //document.getElementById('thePage:itemFormC:theDueDate').value = '';
            
            keepModalOpen();
            return false;
        } 
        else
        {document.getElementById('dateError').style.display = 'none';}
        return true;
    }
        
    function clearDate() {
        document.getElementById('thePage:itemFormC:theDueDate').value = '';
    }
    </script>
    </apex:outputPanel>
    
        <apex:outputPanel >
    <script type="text/javascript">
    function checkTheDateAct() {       
        var theActDate = document.getElementById('thePage:itemFormA:theDueDateAct').value;             
        
        if(theActDate == '')
            {
                document.getElementById('dateErrorAct').style.display = 'none';
                return true;
            }
        
        //Do a regex on the date                 
        //var testResult = /^(((((((0?[13578])|(1[02]))[\/]?((0?[1-9])|([12]\d)|(3[01])))|(((0?[469])|(11))[\/]?((0?[1-9])|([12]\d)|(30)))|((0?2)[\/]?((0?[1-9])|(1\d)|(2[0-8]))))[\/]?(((19)|(20))?([\d][\d]))))|((0?2)[\/]?(29)[\/]?(((19)|(20))?(([02468][048])|([13579][26])))))$/.test(theActDate);
        var testResult = /^(((0?[1-9]|1[012])\/(0?[1-9]|1\d|2[0-8])|(0?[13456789]|1[012])\/(29|30)|(0?[13578]|1[02])\/31)\/(19|[2-3]\d)\d{2}|0?2\/29\/((19|[2-3]\d)(0[48]|[2468][048]|[13579][26])|(([2468][048]|[3579][26])00)))$/.test(theActDate);
        
        //Display an error message in 'errorDate' id it doesn't fit it.
        if(!testResult)
        {
            //alert('Please Correct The Date Format');
            //document.getElementById('dateErrorAct').innerHTML = 'Please Enter Date with MM/DD/YYYY Format';  
            document.getElementById('dateErrorAct').style.display = 'inline';
            //document.getElementById('thePage:itemFormA:theDueDateAct').value = '';
            
            keepModalOpen();
            return false;
        }
        else
        {document.getElementById('dateErrorAct').style.display = 'none';}
        return true;
    }
            
    function clearDateAct() {
           document.getElementById('thePage:itemFormA:theDueDateAct').value = ''; 
    }
            
    function checkTheNameAndDateAct() {        
        var theItemName = document.getElementById('thePage:itemFormA:theActName').value;        
        if(theItemName == '' || theItemName == null) 
        {
            //alert('Please Enter a Name for the Item');            
            document.getElementById('nameErrorAct').style.display = 'inline';
            //document.getElementById('thePage:itemFormC:theActName').focus();
            
            checkTheDateAct();
            
            keepModalOpen();
            return false;
        }
        else
        {
            document.getElementById('nameErrorAct').style.display = 'none';
            
            checkTheDateAct();
            
            return true;
        }  
    }  
    
    var myModalOpened = false; 
            
    function dontHighlightNameBox()
        {myModalOpened = true;}
    function dontHighlightNameBoxAct()
        {myModalOpenedAct = true;}
    
    function openMyModal()
        {                     
            document.getElementById('myModal').style.visibility = 'visible';   
        }

    function openMyModalAct()
        {                     
            document.getElementById('myModalAct').style.visibility = 'visible';   
        }            
            
    function myModalOpenedReset()
        {
            myModalOpened = false;
            document.getElementById('nameError').style.display = 'none';
            document.getElementById('dateError').style.display = 'none';
        }
        
    function setCursorToName(){        
        //alert('doNothing function entered');
        if(myModalOpened == false)
        {document.getElementById('thePage:itemFormC:theItemName').focus();}
        myModalOpened = true;
        return true;    
    }   

    var myModalOpenedAct = false; 
    function myModalOpenedActReset()
        {
            myModalOpenedAct = false;
            document.getElementById('nameErrorAct').style.display = 'none';
            document.getElementById('dateErrorAct').style.display = 'none';
        }                
        
    function setCursorToNameAct(){        
        //alert('doNothing function entered');
        if(myModalOpenedAct == false)
        {document.getElementById('thePage:itemFormA:theActName').focus();}
        myModalOpenedAct = true;
        return true;    
    }             
            
    function keepCalendarOpen() {
        alert('entering keepCalendarOpen function');
        document.getElementById('datePicker').style.display = 'block';
        alert('exiting keepCalendarOpen function');
        }
            
    function doNothing() {return true;}
    </script>
    </apex:outputPanel>
    
    <apex:outputPanel id="jquery">
        <script type="text/javascript">
            var j$ = jQuery.noConflict();
            jQuery(function () {
                j$("[rel='tooltip']").tooltip();
            });
            jQuery(function () {
                j$("[alt='tooltip']").tooltip();
            });
        </script>
    </apex:outputPanel>
    
<div class="container-fluid mainContainer">
        <div class="row-fluid">
            <div class="span2 sidebarClass" style="">
                <apex:outputPanel id="sidebarPanel">
                <apex:panelGroup id="sidebar" style="margin-top=10px" >
                    <div style="position:relative;top:5px;">
                     <div class="heading">
                           <p>Search </p>
                    </div>
                    <apex:form >                            
                        <apex:inputText value="{!searchValue}" id="theSearchInput" title="Search the Whiteboard" styleClass="searchBox">
                        </apex:inputText>
                        <apex:commandButton styleClass="btn btn-primary" action="{!filter}" value="Search" reRender="wholePage" style="margin-top: 10 px; margin-bottom: 25 px"/>
                        <apex:commandButton styleClass="btn" action="{!clearSearch}" value="Clear" reRender="sidebarPanel, wholePage" style="margin-top: 10 px; margin-bottom: 25 px"/>

                       <div class="heading">
                           <p></p>
                           <p>Filter By </p>
                       </div>
                        <apex:selectList value="{!itemOrActivity}"  size="1" multiselect="false" styleClass="picklistBox">
                           <apex:actionsupport event="onchange" action="{!filter}" rerender="wholePage"/>
                           <apex:selectOptions value="{!ItemTask}"></apex:selectOptions>
                        </apex:selectList><br/>
                        <apex:selectList value="{!Priority}"  size="1" multiselect="false" styleClass="picklistBox" title="Sort by">
                           <apex:actionsupport event="onchange" action="{!filter}" rerender="wholePage"/>
                           <apex:selectOptions value="{!items}"></apex:selectOptions>
                        </apex:selectList><br/>
                        <apex:selectList value="{!TimeFrame}"  size="1" multiselect="false" styleClass="picklistBox" title="Filter by"  >
                           <apex:actionsupport event="onchange" action="{!filter}" rerender="wholePage"/>
                           <apex:selectOptions value="{!itemsTwo}"></apex:selectOptions>
                        </apex:selectList><br/>   
                    </apex:form>                      
              </div>
                </apex:panelGroup> 
                </apex:outputPanel>
            </div>  
            <apex:outputPanel id="wholePage" styleClass="wholePage">
            <div class="span10" id="mainSection">
                <div class="row">
                    <div class="span10" id="whiteboardButtons">
                        <apex:form >
                            <apex:commandButton styleClass="btn" id="switchToCompany" action="{!getCompanyItems}" value="Company Whiteboard" reRender=""/>
                            <apex:commandButton styleClass="btn" id="switchToPersonal" action="{!getPersonalItems}" value="Personal Whiteboard"/>
                        </apex:form>
                    </div>
                </div>

                <div class="row">
                    <div class="span12">
                        <apex:sectionHeader title="{!currentWhiteboard}" id="title"/>
                        <button onclick="openMyModal(); myModalOpenedReset()" role="button" class="btn btn-primary" data-toggle="modal" data-backdrop="false">New Item</button>
                    </div>
                    <!-- NEW ITEM MODAL -->
                    <div id="myModal" style="z-index:99;" class="modal invisible" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true" >
                        <apex:form id="itemFormC" onmouseover="setCursorToName();">
                            <div class="modal-header">
                                <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button> -->
                                <h3 id="myModalLabel">{!IF(editIndicator == false, 'New Item', 'Edit Item')}</h3>
                            </div>
                            <div class="modal-body">
                                <span class="modalLabel">Name:</span><apex:inputField id="theItemName" label="Name" value="{!Item.Name}" styleClass="modalInput modalActInput modalItemName"/>
                                <div id="nameError" styleClass="modalInput modalActInput modalItemName" style="color:red; display:none">Please Enter a Name for the Item</div>
                                <br/>                                                                                                
                                <span class="modalLabel">Due Date:</span>                                                                  
                                <apex:inputField id="theDueDate" label="DueDate" value="{!Item.Item_Due_Date__c}" styleClass="modalInput modalActInput modalItemDate"/>                                                                
                                <div id="dateError" styleClass="modalInput modalActInput modalItemDate" style="color:red; display:none">Please Enter a Valid Date or Leave Blank</div>                                
                                <br/>
                                <span class="modalLabel">Assign To:</span>                                                                         
                                      <apex:selectList id="aUser" value="{!assignedUser}" size="1" multiselect="false" styleClass="modalItemAssign">
                                          <apex:selectOptions value="{!UserList}" ></apex:selectOptions> 
                                </apex:selectList><br/>
                                <span class="modalLabel">High Priority:</span><apex:inputCheckbox label="High Priority" value="{!Item.High_Priority__c}" styleClass="modalInput modalItemAssign"/>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleClass="btn btn-primary" action="{!save}" onclick="checkTheNameAndDate();" value="Save" reRender="wholePage"/>  
                                <apex:commandButton styleClass="btn" value="Cancel" action="{!reset}" onclick="clearDate()" reRender="wholePage"/>
                            </div>
                        </apex:form>
                    </div>
                    <!-- END MODAL -->
                </div>
                <br/>
                <div class="heading">
                    <p>Current Items</p>
                </div>                
                
                <apex:outputPanel id="pageContent">
                    <div class="row">
                        <div class="span12">
                            <div class="accordion" id="accordion2" style="margin-bottom: 0px;">
                                <apex:repeat value="{!currentItems}" var="item" id="itemList">  <!-- Starts the repetition of the ITEMS -->
                                    <div class="accordion-group itemBar">
                                        <div class="nav pull-right buttonLine">
                                            <apex:form >
                                                <apex:commandButton alt="tooltip" title="Click to delete" action="{!deleteItem}" value="✖" id="delete" reRender="wholePage" styleClass="close" onclick="if (!confirm('Are you sure you want to delete this item forever?')) {return;};">
                                                    <apex:param name="ItemId" value="{!item.Id}"/>
                                                </apex:commandButton>
                                                <button role="button" class="close btn" data-toggle="modal" data-backdrop="false" onclick="openMyModal(); editItem('{!item.Id}'); dontHighlightNameBox();" rel="tooltip" data-placement="top" title="Click to edit">✎</button>
                                                <button role="button" class="close btn" data-toggle="modal" data-backdrop="false" onclick="itemId='{!item.Id}'; openMyModalAct(); myModalOpenedActReset();" rel="tooltip" data-placement="top" title="Click to add an Activity">✚</button>
                                                <apex:commandLink rel="tooltip" title="Click to toggle priority" styleClass="priority" rendered="{!IF(item.High_Priority__c == true, true, false)}"  action="{!unsetPriority}" rerender="wholePage">
                                                    <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/priority.png')}" width="25"/>
                                                    <apex:param name="ItemId" value="{!item.Id}"/>
                                                </apex:commandLink>
                                                <apex:commandLink rel="tooltip" title="Click to toggle priority" styleClass="priority" rendered="{!IF(item.High_Priority__c == true, false, true)}" action="{!setPriority}" rerender="wholePage">
                                                    <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/nopriority.png')}" width="25"/>
                                                    <apex:param name="ItemId" value="{!item.Id}"/>
                                                </apex:commandLink>
                                                <apex:outputPanel rendered="{!IF(item.assignedTo__r.Name != '', true, false)}">
                                                <div class="assignedUser">Assigned To: 
                                                    <apex:outputText value=" {!item.assignedTo__r.Name}"/>                                                
                                                </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel >
                                                    <div class="itemDate" style="{!IF(item.Past_Due__c == true, 'color: red; font-weight: bold;', '')}">
                                                        <apex:outputText value="{0,date,M'/'dd'/'yyyy}">
                                                            <apex:param value="{!item.Item_Due_Date__c}" /> 
                                                        </apex:outputText>
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:form>
                                        </div>
                                        <div class="nav pull-left buttonLine">
                                            <apex:form >
                                                <div rel="tooltip" href="#" data-toggle="tooltip" data-placement="left" title="Click to mark complete" class="boxLine">
                                                    <apex:commandLink styleClass="completedbox" action="{!completeItem}" rerender="wholePage">
                                                        <apex:param name="ItemId" value="{!item.Id}"/>
                                                    </apex:commandLink>
                                                </div>
                                            </apex:form>
                                        </div>
                                        <div class="accordion-heading" ondblclick="window.location='/{!item.Id}'">
                                            <a class="accordion-toggle itemTitle" data-toggle="collapse" data-parent="#accordion2" href="#{!item.Id}" onclick="toggleicons('{!item.Id}')">
                                                <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, false, true)}">
                                                    <i id="icondown{!item.Id}" class="icon-chevron-down downicon" style="display: ;"></i>
                                                </apex:outputPanel>
                                                <apex:outputPanel >
                                                    <i id="iconup{!item.Id}" class="icon-chevron-up downicon" style="display: none;"></i>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, true, false)}">
                                                    <i id="iconBlank" class="iconBlank downicon"></i>
                                                </apex:outputPanel>
                                                <apex:outputPanel >
                                                    <div class="nameLine">{!item.Name}</div>
                                                </apex:outputPanel>
                                            </a>
                                        </div>
                                        <div id="{!item.Id}" class="accordion-body collapse">
                                            <apex:outputPanel id="curRow">
                                            <apex:repeat value="{!item.Whiteboard_Item_Activities__r}" var="act" id="actList" rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, false, true)}">
                                                <hr style="margin: 0 0 0 0; padding: 0 0 0 0;"/>
                                                <div class="accordion-inner activityRow" style="margin-left: 33px; {!IF(act.Completed__c == true, 'opacity: .6;', '')}">
                                                    <div class="nav pull-right buttonLine">
                                                        <apex:form >
                                                            <apex:commandButton action="{!deleteAct}" value="✖" id="delete" reRender="curRow" styleClass="{!IF(act.Completed__c == true, 'btn close restoreButton trashButton', 'close')}" onclick="if (!confirm('Are you sure you want to delete this activity forever?')) {return;};">
                                                                <apex:param name="ActId" value="{!act.Id}"/>
                                                            </apex:commandButton>
                                                            <button role="button" class="close btn" data-toggle="modal" data-backdrop="false" onclick="openMyModalAct(); editActivity('{!act.Id}'); dontHighlightNameBoxAct();" data-placement="top" style="{!IF(act.Completed__c == true, 'display: none !important; ', '')}">✎</button>
                                                            <apex:commandLink styleClass="priority" rendered="{!IF(AND(act.High_Priority__c == true, act.Completed__c == false), true, false)}"  action="{!unsetActPriority}" rerender="curRow">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/priority2.png')}" width="25"/>
                                                                <apex:param name="ActId" value="{!act.Id}"/>
                                                            </apex:commandLink>
                                                            <apex:commandLink styleClass="priority" rendered="{!IF(AND(act.High_Priority__c == false, act.Completed__c == false), true, false)}" action="{!setActPriority}" rerender="curRow">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/nopriority.png')}" width="25"/>
                                                                <apex:param name="ActId" value="{!act.Id}"/>
                                                            </apex:commandLink>
                                                            <div Class="prioritydone" style="{!IF(AND(act.High_Priority__c == true, act.Completed__c == true), 'margin-right:40px;', 'display:none')}">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/prioritydone.png')}" width="25"/>
                                                            </div>
                                                            <div Class="prioritydone" style="{!IF(AND(act.High_Priority__c == false, act.Completed__c == true), 'margin-right:40px;', 'display:none')}">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/nopriority.png')}" width="25"/>
                                                            </div>
                                                            <apex:outputPanel rendered="{!IF(AND(act.actAssignedTo__r.Name != '', act.Completed__c == false), true, false)}">
                                                                <div class="actAssignedUser">Assigned To: 
                                                                    <apex:outputText value=" {!act.actAssignedTo__r.Name}"/>                                                
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, true, false)}">
                                                                <div class="completedby">
                                                                    <apex:outputText value="Completed By: {!act.CompletedBy__r.Name} on {!act.Completed_Date__c}" />
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == false, true, false)}">
                                                                <div class="actDate" style="{!IF(act.Past_Due__c == true, 'color: red; font-weight: bold;', '')}">
                                                                    <apex:outputText value="{0,date,M'/'dd'/'yyyy}">
                                                                        <apex:param value="{!act.Due_Date__c}" /> 
                                                                    </apex:outputText>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:form>
                                                    </div>
                                                    <div class="nav pull-left buttonLine">
                                                        <apex:form >
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, false, true)}">
                                                                <apex:commandLink styleClass="completedbox" action="{!completeAct}" rerender="curRow">
                                                                    <apex:param name="ActId" value="{!act.Id}"/>
                                                                </apex:commandLink>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, true, false)}">
                                                                <apex:commandLink styleClass="uncompletedbox" action="{!uncompleteAct}" rerender="curRow">
                                                                    <apex:param name="ActId" value="{!act.Id}"/>
                                                                </apex:commandLink>
                                                            </apex:outputPanel>
                                                        </apex:form>
                                                    </div>
                                                    <!-- ITEM INNER ACCORDION -->
                                                    <div class="accordion-heading" ondblclick="window.location='/{!act.Id}'">
                                                        <a class="accordion-toggle activityTitle" data-toggle="collapse" data-parent="#accordion3" href="#{!act.Id}" onclick="toggleacticons('{!act.Id}')">
                                                            <apex:outputPanel rendered="{!IF(act.Description__c == '', false, true)}">
                                                                <i id="icondown{!act.Id}" class="icon-chevron-down downicon actIcon" style="display: ;"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <i id="iconup{!act.Id}" class="icon-chevron-up downicon actIcon" style="display: none;"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(act.Description__c == '', true, false)}">
                                                                <i class="actIconBlank"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="nameLine" style="{!IF(act.Completed__c == true, 'text-decoration: line-through', '')}">{!act.Name}</div>
                                                            </apex:outputPanel>
                                                        </a>
                                                    </div>
                                                    <apex:outputPanel rendered="{!IF(act.Description__c == '', false, true)}">
                                                    <div id="{!act.Id}" class="accordion-body collapse">
                                                        <div class="accordion-inner">
                                                            <ul class="listWrapper">
                                                                <apex:outputPanel rendered="{!IF(act.Description__c == '', false, true)}">
                                                                    <div class="activityDescription {!IF(act.Completed__c == true, 'trashLine', '')}">
                                                                        <li>{!act.Description__c}</li>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    </apex:outputPanel>                                                    
                                                    <apex:outputPanel rendered="{!IF(act.Description__c == '', true, false)}">
                                                        <div id="{!act.Id}" class="accordion-body collapse">
                                                            <div class="accordion-inner">
                                                                <ul class="listWrapper">
                                                                    <div class="activityDescription">
                                                                        <li>No description specified</li>
                                                                    </div>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <!-- END ACCORDION -->
                                                </div>
                                            </apex:repeat>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, true, false)}" >
                                                <div class="accordion-inner activityRow">
                                                    <!-- ITEM INNER ACCORDION -->
                                                    <div class="accordion-heading noActivities">
                                                        <a class="accordion-toggle activityTitle" data-toggle="collapse" data-parent="#accordion3">
                                                            No Activities
                                                        </a>
                                                    </div>
                                                    <!-- END ACCORDION -->
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                    </div>
                                </apex:repeat>
                            </div>
                        </div>
                    </div>
                </apex:outputPanel> <!-- Ends the list of Items -->
    
                <!-- NEW Activity MODAL -->
                <div id="myModalAct" style="z-index:99" class="modal invisible" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <apex:form id="itemFormA" onmouseover="setCursorToNameAct();">
                        <apex:inputHidden id="whiteboardId" value="{!whiteboardId}"/>
                        <div class="modal-header">
                            <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button> -->
                            <h3 id="myModalLabel">{!IF(editIndicator == false, 'New Activity', 'Edit Activity')}</h3>
                        </div>
                        <div class="modal-body">
                            <span class="modalLabel">Name:</span><apex:inputField id="theActName" label="Name" value="{!activity.Name}" styleClass="modalActInput modalName"/>
                            <div id="nameErrorAct" styleClass="modalActInput modalName" style="color:red; display:none">Please Enter a Name for the Activity</div>
                            
                            <br/>
                            <span class="modalLabel">Description:</span><apex:inputField label="Description" value="{!activity.Description__c}" styleClass="modalActInput modalDescription"/><br/>
                            
                            <span class="modalLabel">Due Date:</span>
                            <apex:inputField id="theDueDateAct" label="Due Date" value="{!activity.Due_Date__c}" styleClass="modalActInput modalDate"/>
                            <div id="dateErrorAct" styleClass="modalActInput modalDate" style="color:red; display:none">Please Enter a Valid Date or Leave Blank</div>
                            
                            <br/>                            
                            <span class="modalLabel">Assign To:</span>   
                            <apex:selectList id="actUser" value="{!activity.actAssignedTo__c}" size="1" multiselect="false" styleClass="modalAssign">
                                <apex:selectOptions value="{!UserList}" ></apex:selectOptions> 
                            </apex:selectList><br/>
                            <span class="modalLabel">High Priority:</span><apex:inputCheckbox label="High Priority" value="{!activity.High_Priority__c}" styleClass="modalActInput"/>
                        </div>
                        <div class="modal-footer">
                            <apex:commandButton styleClass="btn btn-primary" action="{!saveAct}" value="Save" onclick="setWhiteboardId(); checkTheNameAndDateAct();" reRender="wholePage"/>
                            <apex:commandButton styleClass="btn" value="Cancel" action="{!reset}" onclick="clearDateAct()" reRender="wholePage"/>
                        </div>
                    </apex:form>
                </div>
                <!-- END MODAL -->
                
                <hr/>
                <div class="heading">
                    <p>Completed Items</p>
                </div>
                <apex:outputPanel id="completedContent">
                <div class="row">
                    <div class="span12">
                        <div class="accordion" id="accordion4">
                            <apex:repeat value="{!completedItems}" var="item" id="completedItemList">   <!-- Starts the repetition of the ITEMS -->
                                <div class="accordion-group itemBarTrash">
                                    <div class="nav pull-right buttonLine">
                                        <apex:form >
                                            <apex:commandButton action="{!deleteItem}" value="✖" id="delete" reRender="wholePage" styleClass="btn close trashButton" onclick="if (!confirm('Are you sure you want to delete this item forever?')) {return;};">
                                                <apex:param name="ItemId" value="{!item.Id}"/>
                                            </apex:commandButton>
                                            <div Class="prioritydone" style="{!IF(item.High_Priority__c == true, true, 'display:none')}">
                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/prioritydone.png')}" width="25"/>
                                            </div>
                                            <div Class="prioritydone" style="{!IF(item.High_Priority__c == false, true, 'display:none')}">
                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/nopriority.png')}" width="25"/>
                                            </div>
                                            <div class="completedby">
                                                <apex:outputText value="Completed By: {!item.CompletedBy__r.Name} on {!item.Completed_Date__c}" />
                                            </div>
                                        </apex:form>
                                     </div>
                                    <div class="nav pull-left buttonLine">
                                        <apex:form >
                                            <apex:commandLink styleClass="uncompletedbox" action="{!uncompleteItem}" rerender="wholePage" id="untrash">
                                                <apex:param name="ItemId" value="{!item.Id}"/>
                                            </apex:commandLink>
                                        </apex:form>
                                    </div>
                                    <div class="accordion-heading" ondblclick="window.location='/{!item.Id}'">
                                        <a class="accordion-toggle itemTitle" data-toggle="collapse" data-parent="#accordion2" href="#{!item.Id}"  onclick="toggleicons('{!item.Id}')">
                                            <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, false, true)}">
                                                <i id="icondown{!item.Id}" class="icon-chevron-down downicontrash" style="display: ;"></i>
                                            </apex:outputPanel>
                                            <apex:outputPanel >
                                                <i id="iconup{!item.Id}" class="icon-chevron-up downicontrash" style="display: none;"></i>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, true, false)}">
                                                <i class="iconBlankTrash downicon"></i>
                                            </apex:outputPanel>
                                            <apex:outputPanel >
                                                <div class="nameLineTrash">{!item.Name}</div>
                                            </apex:outputPanel>
                                        </a>
                                    </div>
                                    <div id="{!item.Id}" class="accordion-body collapse">
                                            <apex:outputPanel id="trashRow">
                                            <apex:repeat value="{!item.Whiteboard_Item_Activities__r}" var="act" id="actList" rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, false, true)}">
                                                <hr style="margin: 0 0 0 0; padding: 0 0 0 0; border-top: 1px solid #aaaaaa; border-bottom: 1px solid #eeeeee;"/>
                                                <div class="accordion-inner activityRow" style="margin-left:27px">
                                                    <div class="nav pull-right buttonLine">
                                                        <apex:form >
                                                            <apex:commandButton action="{!deleteAct}" value="✖" id="delete" reRender="trashRow" styleClass="btn close trashButton" onclick="if (!confirm('Are you sure you want to delete this activity forever?')) {return;};">
                                                                <apex:param name="ActId" value="{!act.Id}"/>
                                                            </apex:commandButton>
                                                            <div Class="prioritydone" style="{!IF(act.High_Priority__c == true, true, 'display:none')}">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/prioritydone.png')}" width="25"/>
                                                            </div>
                                                            <div Class="prioritydone" style="{!IF(act.High_Priority__c == false, true, 'display:none')}">
                                                                <apex:image url="{!URLFOR($Resource.bootstrap, '/bootstrap/img/nopriority.png')}" width="25"/>
                                                            </div>
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, true, false)}">
                                                                <div class="completedby">
                                                                    <apex:outputText value="Completed By: {!act.CompletedBy__r.Name} on {!act.Completed_Date__c}" />
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:form>
                                                    </div>
                                                    <div class="nav pull-left buttonLine">
                                                        <apex:form >
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, false, true)}">
                                                                <div class="completedboxTrash">
                                                                    <apex:param name="ActId" value="{!act.Id}"/>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(act.Completed__c == true, true, false)}">
                                                                <div class="uncompletedboxTrash">
                                                                    <apex:param name="ActId" value="{!act.Id}"/>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:form>
                                                    </div>
                                                    <!-- ITEM INNER ACCORDION -->
                                                    <div class="accordion-heading" ondblclick="window.location='/{!act.Id}'">
                                                        <a class="accordion-toggle activityTitle" data-toggle="collapse" data-parent="#accordion3" href="#{!act.Id}" onclick="toggleacticons('{!act.Id}')">
                                                            <apex:outputPanel rendered="{!IF(AND(act.Description__c == '', ISBLANK(act.Due_Date__c)), false, true)}">
                                                                <i id="icondown{!act.Id}" class="icon-chevron-down downicon actIcon" style="display: ;"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <i id="iconup{!act.Id}" class="icon-chevron-up downicon actIcon" style="display: none;"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(AND(act.Description__c == '', ISBLANK(act.Due_Date__c)), true, false)}">
                                                                <i class="actIconBlank"></i>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="nameLine trashLine">{!act.Name}</div>
                                                            </apex:outputPanel>
                                                        </a>
                                                    </div>
                                                    <apex:outputPanel rendered="{!IF(AND(act.Description__c == '', ISBLANK(act.Due_Date__c)), false, true)}">
                                                    <div id="{!act.Id}" class="accordion-body collapse">
                                                        <div class="accordion-inner">
                                                            <ul class="listWrapper">
                                                                <apex:outputPanel rendered="{!IF(act.Description__c == '', false, true)}">
                                                                    <div class="activityDescription trashLine">
                                                                        <li>{!act.Description__c}</li>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!IF(ISBLANK(act.Due_Date__c), false, true)}">
                                                                    <div class="activityDate trashLine">
                                                                        <li><apex:outputField value="{!act.Due_Date__c}"/></li>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!IF(AND(act.Description__c == '', ISBLANK(act.Due_Date__c)), true, false)}">
                                                        <div id="{!act.Id}" class="accordion-body collapse">
                                                            <div class="accordion-inner">
                                                                <ul class="listWrapper" style="margin-left: 20px;">
                                                                    <li>No description or due date specified</li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <!-- END ACCORDION -->
                                                </div>
                                            </apex:repeat>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!IF(item.Whiteboard_Item_Activities__r.size == 0, true, false)}" >
                                                <div class="accordion-inner activityRow">
                                                    <!-- ITEM INNER ACCORDION -->
                                                    <div class="accordion-heading trashLine">
                                                        <a class="accordion-toggle activityTitle noActivities" data-toggle="collapse" data-parent="#accordion3">
                                                            No Activities
                                                        </a>
                                                    </div>
                                                    <!-- END ACCORDION -->
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                </div>
                            </apex:repeat>
                        </div>
                    </div>
                </div> <!-- ENDS trashed secion -->
                </apex:outputPanel>
                
            </div> <!-- ENDS main page section -->
            </apex:outputPanel>
        </div> <!-- ENDS row fluid -->

    </div> <!-- ENDS container-fluid -->
    
    <apex:form >
        <apex:actionFunction name="editItem" action="{!editItem}" rerender="itemFormC">
            <apex:param name="itemid" assignTo="{!ItemId}" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="editActivity" action="{!editActivity}" rerender="itemFormA">
            <apex:param name="activityId" assignTo="{!activityId}" value="" />
        </apex:actionFunction>
    </apex:form>

               
</apex:page>